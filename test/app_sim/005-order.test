# -*-Tcl-*-
#-----------------------------------------------------------------------
# TITLE:
#    005-order.test
#
# AUTHOR:
#    Will Duquette
#
# DESCRIPTION:
#    app_sim(1) Order Processor tests.
#
#    This test suite tests the order processor itself.
#    Much of it is still TBD.
#
#-----------------------------------------------------------------------

#-----------------------------------------------------------------------
# Test Suite
#
# The tests run in a namespace so as not to interfere with other
# test suites.

namespace eval ::athena_test::tests:: {
    #-------------------------------------------------------------------
    # Set up the test environment

    # Import tcltest(n)
    namespace import ::tcltest::*

    order define DUMMY:ORDER {
        title "Dummy Order"
        parm this text "This Parm"
        parm that text "That Parm"
    } {
        # Nothing to be done
    }

    #-------------------------------------------------------------------
    # send

    test send-1.1 {send command with invalid parameters} -body {
        ted order DUMMY:ORDER this 1 that 2 nonesuch 3
    } -returnCodes {
        error
    } -result {Unknown parameter: "nonesuch"}

    #-------------------------------------------------------------------
    # check

    test check-1.1 {invalid order returns error} -body {
        order check GROUP:CIVILIAN:CREATE
    } -returnCodes {
        error
    } -result {g {required value} longname {required value} color {required value} shape {required value}}

    test check-1.2 {valid order doesn't execute} -body {
        order check GROUP:CIVILIAN:CREATE \
            g SHIA longname "Local Shia" color "#000000" shape NEUTRAL
        civgroup names
    } -result {}


    #-------------------------------------------------------------------
    # Cleanup

    cleanupTests
}

namespace delete ::athena_test::tests::




